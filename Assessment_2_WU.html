<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.6.39">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Harley Burrow (2318180)">

<title>PM-272 Assignment 2: Using Machine Learning to Predict the Pathogenic Outcomes of Genetic Mutations for Epilepsy and Muscular Condition Phenotypes</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="Assessment_2_WU_files/libs/clipboard/clipboard.min.js"></script>
<script src="Assessment_2_WU_files/libs/quarto-html/quarto.js"></script>
<script src="Assessment_2_WU_files/libs/quarto-html/popper.min.js"></script>
<script src="Assessment_2_WU_files/libs/quarto-html/tippy.umd.min.js"></script>
<script src="Assessment_2_WU_files/libs/quarto-html/anchor.min.js"></script>
<link href="Assessment_2_WU_files/libs/quarto-html/tippy.css" rel="stylesheet">
<link href="Assessment_2_WU_files/libs/quarto-html/quarto-syntax-highlighting-e26003cea8cd680ca0c55a263523d882.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="Assessment_2_WU_files/libs/bootstrap/bootstrap.min.js"></script>
<link href="Assessment_2_WU_files/libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="Assessment_2_WU_files/libs/bootstrap/bootstrap-8a79a254b8e706d3c925cde0a310d4f0.min.css" rel="stylesheet" append-hash="true" id="quarto-bootstrap" data-mode="light">


</head>

<body class="fullcontent">

<div id="quarto-content" class="page-columns page-rows-contents page-layout-article">

<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">PM-272 Assignment 2: Using Machine Learning to Predict the Pathogenic Outcomes of Genetic Mutations for Epilepsy and Muscular Condition Phenotypes</h1>
</div>



<div class="quarto-title-meta">

    <div>
    <div class="quarto-title-meta-heading">Author</div>
    <div class="quarto-title-meta-contents">
             <p>Harley Burrow (2318180) </p>
          </div>
  </div>
    
  
    
  </div>
  


</header>


<section id="introduction-to-the-datasets" class="level1">
<h1>Introduction to the Datasets</h1>
<section id="dataset-1---humvar" class="level3">
<h3 class="anchored" data-anchor-id="dataset-1---humvar">Dataset 1 - Humvar</h3>
<p>This dataset describes the aspects of 36,684 genetic variants and whether their presence results in a benign or pathogenic outcome for health. It will be used to train the machine learning (ML) model which will then be able to specifically predict the likelihood of genetic variants causing epilepsy and muscular conditions.</p>
</section>
<section id="dataset-2---lab-variants" class="level3">
<h3 class="anchored" data-anchor-id="dataset-2---lab-variants">Dataset 2 - Lab Variants</h3>
<p>This shows a list of mutations (including mutation ID) and whether they cause epilepsy or muscular conditions. It will be used to match these same mutation IDs on the third dataset with their corresponding variant benignity predictors.</p>
</section>
<section id="dataset-3---variants-annotated" class="level3">
<h3 class="anchored" data-anchor-id="dataset-3---variants-annotated">Dataset 3 - Variants Annotated</h3>
<p>This shows the variant benignity predictors for each mutation ID. It will be merged with the Lab Variants dataset to run the ML model that will predict whether each mutation ID and their predictors will be likely to result in a benign or pathogenic epilepsy/muscular condition phenotype.</p>
</section>
</section>
<section id="explanation-of-the-code" class="level1">
<h1>Explanation of the Code</h1>
<section id="read-in-the-datasets-and-required-libraries" class="level2">
<h2 class="anchored" data-anchor-id="read-in-the-datasets-and-required-libraries">Read in the Datasets and Required Libraries</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a>db<span class="fl">.1</span> <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="st">"humvar.csv"</span>) </span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a>db<span class="fl">.2</span> <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="st">"lab_variants.csv"</span>)</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a>db<span class="fl">.3</span> <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="st">"variants_annotated.csv"</span>)</span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(randomForest)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>randomForest 4.7-1.2</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Type rfNews() to see new features/changes/bug fixes.</code></pre>
</div>
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: package 'readr' was built under R version 4.4.2</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: package 'dplyr' was built under R version 4.4.2</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>── Attaching core tidyverse packages ──────────────────────── tidyverse 2.0.0 ──
✔ dplyr     1.1.4     ✔ readr     2.1.5
✔ forcats   1.0.0     ✔ stringr   1.5.1
✔ ggplot2   3.5.1     ✔ tibble    3.2.1
✔ lubridate 1.9.3     ✔ tidyr     1.3.1
✔ purrr     1.0.2     </code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>── Conflicts ────────────────────────────────────────── tidyverse_conflicts() ──
✖ dplyr::combine()  masks randomForest::combine()
✖ dplyr::filter()   masks stats::filter()
✖ dplyr::lag()      masks stats::lag()
✖ ggplot2::margin() masks randomForest::margin()
ℹ Use the conflicted package (&lt;http://conflicted.r-lib.org/&gt;) to force all conflicts to become errors</code></pre>
</div>
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(pROC)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: package 'pROC' was built under R version 4.4.2</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Type 'citation("pROC")' for a citation.

Attaching package: 'pROC'

The following objects are masked from 'package:stats':

    cov, smooth, var</code></pre>
</div>
</div>
<section id="randomforest" class="level3">
<h3 class="anchored" data-anchor-id="randomforest">randomForest</h3>
<p>I loaded in the “randomForest” library so I could run the random forest algorithms to train the ML model and make predictions.</p>
</section>
<section id="tidyverse" class="level3">
<h3 class="anchored" data-anchor-id="tidyverse">tidyverse</h3>
<p>I loaded in the “tidyverse” library to help me transform and present data.</p>
</section>
<section id="proc" class="level3">
<h3 class="anchored" data-anchor-id="proc">pROC</h3>
<p>I loaded in the “pROC” library so I could produce the receiver operating characteristic (ROC) curve.</p>
</section>
</section>
<section id="create-the-training-and-test-sets-for-humvar" class="level2">
<h2 class="anchored" data-anchor-id="create-the-training-and-test-sets-for-humvar">Create the Training and Test Sets for Humvar</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(<span class="fu">is.na</span>(db<span class="fl">.1</span>)) <span class="co"># Check for missing data </span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> DANN_score      GM12878_fitCons_score GM12878_fitCons_score_rankscore
 Mode :logical   Mode :logical         Mode :logical                  
 FALSE:38684     FALSE:38684           FALSE:38684                    
 GenoCanyon_score GenoCanyon_score_rankscore H1.hESC_fitCons_score
 Mode :logical    Mode :logical              Mode :logical        
 FALSE:38684      FALSE:38684                FALSE:38684          
 H1.hESC_fitCons_score_rankscore HUVEC_fitCons_score
 Mode :logical                   Mode :logical      
 FALSE:38684                     FALSE:38684        
 HUVEC_fitCons_score_rankscore MetaLR_score    MutationAssessor_score_rankscore
 Mode :logical                 Mode :logical   Mode :logical                   
 FALSE:38684                   FALSE:38684     FALSE:38684                     
 REVEL_score     fathmm.MKL_coding_score integrated_fitCons_score
 Mode :logical   Mode :logical           Mode :logical           
 FALSE:38684     FALSE:38684             FALSE:38684             
 integrated_fitCons_score_rankscore PolyPhen_score  SIFT_score     
 Mode :logical                      Mode :logical   Mode :logical  
 FALSE:38684                        FALSE:38684     FALSE:38684    
 CADD_raw_rankscore DANN_rankscore  Eigen.PC.raw_rankscore
 Mode :logical      Mode :logical   Mode :logical         
 FALSE:38684        FALSE:38684     FALSE:38684           
 FATHMM_converted_rankscore GERP.._RS_rankscore
 Mode :logical              Mode :logical      
 FALSE:38684                FALSE:38684        
 GM12878_fitCons_score_rankscore.1 GenoCanyon_score_rankscore.1
 Mode :logical                     Mode :logical               
 FALSE:38684                       FALSE:38684                 
 H1.hESC_fitCons_score_rankscore.1 HUVEC_fitCons_score_rankscore.1
 Mode :logical                     Mode :logical                  
 FALSE:38684                       FALSE:38684                    
 MetaLR_rankscore MetaSVM_rankscore MutationAssessor_score_rankscore.1
 Mode :logical    Mode :logical     Mode :logical                     
 FALSE:38684      FALSE:38684       FALSE:38684                       
 MutationTaster_converted_rankscore REVEL_rankscore
 Mode :logical                      Mode :logical  
 FALSE:38684                        FALSE:38684    
 SiPhy_29way_logOdds_rankscore VEST3_rankscore fathmm.MKL_coding_rankscore
 Mode :logical                 Mode :logical   Mode :logical              
 FALSE:38684                   FALSE:38684     FALSE:38684                
 integrated_fitCons_score_rankscore.1 phastCons100way_vertebrate_rankscore
 Mode :logical                        Mode :logical                       
 FALSE:38684                          FALSE:38684                         
 phastCons20way_mammalian_rankscore phyloP100way_vertebrate_rankscore
 Mode :logical                      Mode :logical                    
 FALSE:38684                        FALSE:38684                      
 phyloP20way_mammalian_rankscore Reliability_index GERP.._NR      
 Mode :logical                   Mode :logical     Mode :logical  
 FALSE:38684                     FALSE:38684       FALSE:38684    
 SiPhy_29way_logOdds SiPhy_29way_logOdds_rankscore.1 phastCons20way_mammalian
 Mode :logical       Mode :logical                   Mode :logical           
 FALSE:38684         FALSE:38684                     FALSE:38684             
 df.freq.gnomAD_exomes_AF df.freq.gnomAD_genomes_AF   labels       
 Mode :logical            Mode :logical             Mode :logical  
 FALSE:38684              FALSE:38684               FALSE:38684    </code></pre>
</div>
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a>humvar_shuffled <span class="ot">&lt;-</span> db<span class="fl">.1</span>[<span class="fu">sample</span>(<span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(db<span class="fl">.1</span>)),] <span class="co"># Shuffle the data set so it's random and unbiased</span></span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-3"><a href="#cb14-3" aria-hidden="true" tabindex="-1"></a>humvar_bound <span class="ot">&lt;-</span> <span class="fu">nrow</span>(humvar_shuffled) <span class="sc">*</span> <span class="fl">0.75</span> <span class="co"># select 75% of the data</span></span>
<span id="cb14-4"><a href="#cb14-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-5"><a href="#cb14-5" aria-hidden="true" tabindex="-1"></a>humvar_train <span class="ot">&lt;-</span> humvar_shuffled[<span class="dv">1</span><span class="sc">:</span>humvar_bound,] <span class="co"># Assign first 75% of rows for training</span></span>
<span id="cb14-6"><a href="#cb14-6" aria-hidden="true" tabindex="-1"></a>humvar_test <span class="ot">&lt;-</span> humvar_shuffled[(humvar_bound<span class="sc">+</span><span class="dv">1</span>)<span class="sc">:</span><span class="fu">nrow</span>(humvar_shuffled),] <span class="co"># Assign remaining 25% of rows to the test set</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>“summary(is.na(db.1))” checks the Humvar dataset for any missing data that may have to be removed/completed. Fortunately there was no missing data so no further completion was required.</p>
<p>I then shuffled the dataset using the sample() function. I did this because it made sure to eliminate any bias that might have arisen from the order that the genetic variants had been listed.</p>
<p>Using “nrow(humvar_shuffled) * 0.75” I selected 75% of the rows in the shuffled training data. I then assigned this 75% to the training set (“humvar_train &lt;- humvar_shuffled[1:humvar_bound,]”), and the remaining 25% to the test set (“humvar_test &lt;- humvar_shuffled[(humvar_bound+1):nrow(humvar_shuffled),]”).</p>
<p>Using a 75:25 ratio for the training and testing sets was important because having a higher amount of data to train the ML model means it will be more accurate, but I also needed enough data in the test set to ensure the accuracy, and true positive and false positive rates were accurate enough to the true rates.</p>
</section>
<section id="train-the-random-forest-model" class="level2">
<h2 class="anchored" data-anchor-id="train-the-random-forest-model">Train the Random Forest Model</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a>humvar_train_rf <span class="ot">&lt;-</span> <span class="fu">randomForest</span>(<span class="fu">as.factor</span>(labels) <span class="sc">~</span> ., <span class="at">data =</span> humvar_train) <span class="co"># Run the random forest to train the ML model</span></span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a>humvar_train_rf <span class="co"># Output the results of the random forest </span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
 randomForest(formula = as.factor(labels) ~ ., data = humvar_train) 
               Type of random forest: classification
                     Number of trees: 500
No. of variables tried at each split: 6

        OOB estimate of  error rate: 6.33%
Confusion matrix:
           Benign Pathogenic class.error
Benign      18036       1031  0.05407248
Pathogenic    806       9140  0.08103760</code></pre>
</div>
</div>
<p>The as.factor() function tells the randomForest that “labels” is categorical data (data that can take one of a certain number of categories) and not continuous data. This was important to make sure the random forest was classification based rather than regression based. I used random forest as it runs many decision trees, meaning it will be highly accurate and will plot a more accurate ROC curve later.</p>
<p>The OOB estimate of error rate represents the percentage of the predictions made on out-of-bag samples (the third of the data not used in each decision tree) that were incorrect. The class errors depict the proportion of benign and pathogenic labels that were incorrectly predicted</p>
</section>
<section id="make-the-humvar-prediction-and-find-accuracy-true-positive-rate-and-false-positive-rate" class="level2">
<h2 class="anchored" data-anchor-id="make-the-humvar-prediction-and-find-accuracy-true-positive-rate-and-false-positive-rate">Make the Humvar Prediction, and Find Accuracy, True Positive Rate and False Positive Rate</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a>humvar_pred <span class="ot">&lt;-</span> <span class="fu">predict</span>(humvar_train_rf, humvar_test) <span class="co"># Make the prediction on the test set using the trained ML model</span></span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(humvar_pred) <span class="co"># View the first six results of the prediction</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>     17360      37264      15011       3193      38469       9331 
    Benign Pathogenic     Benign Pathogenic     Benign Pathogenic 
Levels: Benign Pathogenic</code></pre>
</div>
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a>humvar_cm <span class="ot">&lt;-</span> <span class="fu">table</span>(humvar_pred,humvar_test<span class="sc">$</span>labels) <span class="co"># Save the prediction into a confusion matrix</span></span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-3"><a href="#cb19-3" aria-hidden="true" tabindex="-1"></a>humvar_cm <span class="co"># View the prediction confusion matrix</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>            
humvar_pred  Benign Pathogenic
  Benign       5994        297
  Pathogenic    337       3043</code></pre>
</div>
</div>
<p>Creating a confusion matrix and saving it as an object meant that I could calculate the accuracy, true positive rate and false positive rate for the model based on the coordinates of the test data’s confusion matrix which made coding the calculations quicker.</p>
<p>The top label of the confusion matrix shows what label the model predicted, and the left-hand label of the confusion matrix shows the true label. As such…</p>
<p>[1,1] = True negative/TN</p>
<p>[2,2] = True positive/TP</p>
<p>[1,2] = False positive/FP</p>
<p>[2,1] = False negative/FN</p>
<p>Accuracy = (TN + TP) / (TN + TP + FN + FP) = % of variants’ pathogenic outcome that were predicted correctly</p>
<p>True positive rate = (TP) / (TP + FN) = % of pathogenic variants that were labelled as pathogenic</p>
<p>False positive rate = (FP) / (FP + TN) = % of benign variants that were labelled as pathogenic</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a>humvar_pred_accuracy <span class="ot">&lt;-</span> (humvar_cm[<span class="dv">1</span>,<span class="dv">1</span>]<span class="sc">+</span>humvar_cm[<span class="dv">2</span>,<span class="dv">2</span>]) <span class="sc">/</span> (humvar_cm[<span class="dv">1</span>,<span class="dv">1</span>] <span class="sc">+</span> humvar_cm[<span class="dv">1</span>,<span class="dv">2</span>] <span class="sc">+</span> humvar_cm[<span class="dv">2</span>,<span class="dv">1</span>] <span class="sc">+</span> humvar_cm[<span class="dv">2</span>,<span class="dv">2</span>]) <span class="co"># Find accuracy</span></span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a>humvar_pred_accuracy</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.9344432</code></pre>
</div>
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a>humvar_pred_TPR <span class="ot">&lt;-</span> (humvar_cm[<span class="dv">2</span>,<span class="dv">2</span>]) <span class="sc">/</span> (humvar_cm[<span class="dv">2</span>,<span class="dv">1</span>] <span class="sc">+</span> humvar_cm[<span class="dv">2</span>,<span class="dv">2</span>]) <span class="co"># Find true positive rate</span></span>
<span id="cb23-2"><a href="#cb23-2" aria-hidden="true" tabindex="-1"></a>humvar_pred_TPR</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.9002959</code></pre>
</div>
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a>humvar_pred_FPR <span class="ot">&lt;-</span> (humvar_cm[<span class="dv">1</span>,<span class="dv">2</span>]) <span class="sc">/</span> (humvar_cm[<span class="dv">1</span>,<span class="dv">2</span>] <span class="sc">+</span> humvar_cm[<span class="dv">1</span>,<span class="dv">1</span>]) <span class="co"># Find false positive rate</span></span>
<span id="cb25-2"><a href="#cb25-2" aria-hidden="true" tabindex="-1"></a>humvar_pred_FPR</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.0472103</code></pre>
</div>
</div>
</section>
<section id="join-db.2-db.3-to-show-id-label-and-phenotype" class="level2">
<h2 class="anchored" data-anchor-id="join-db.2-db.3-to-show-id-label-and-phenotype">Join db.2 &amp; db.3 to Show ID, label, and phenotype</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb27"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a>pheno_patho_joined <span class="ot">&lt;-</span> <span class="fu">inner_join</span>(db<span class="fl">.2</span>, db<span class="fl">.3</span>, <span class="at">by =</span> <span class="st">"ids"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="filter-new-table-to-only-show-epilepsy-or-muscular-conditions" class="level2">
<h2 class="anchored" data-anchor-id="filter-new-table-to-only-show-epilepsy-or-muscular-conditions">Filter New Table To Only Show Epilepsy OR Muscular Conditions</h2>
<p>First I checked to see if there were any rows with missing data:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb28"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(<span class="fu">is.na</span>(pheno_patho_joined)) <span class="co"># Check for missing data as above</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>    ids          phenotype       DANN_score      GM12878_fitCons_score
 Mode :logical   Mode :logical   Mode :logical   Mode :logical        
 FALSE:857       FALSE:857       FALSE:857       FALSE:857            
                                                                      
 GM12878_fitCons_score_rankscore GenoCanyon_score GenoCanyon_score_rankscore
 Mode :logical                   Mode :logical    Mode :logical             
 FALSE:857                       FALSE:832        FALSE:857                 
                                 TRUE :25                                   
 H1.hESC_fitCons_score H1.hESC_fitCons_score_rankscore HUVEC_fitCons_score
 Mode :logical         Mode :logical                   Mode :logical      
 FALSE:857             FALSE:857                       FALSE:857          
                                                                          
 HUVEC_fitCons_score_rankscore MetaLR_score    MutationAssessor_score_rankscore
 Mode :logical                 Mode :logical   Mode :logical                   
 FALSE:857                     FALSE:857       FALSE:857                       
                                                                               
 REVEL_score     fathmm.MKL_coding_score integrated_fitCons_score
 Mode :logical   Mode :logical           Mode :logical           
 FALSE:857       FALSE:857               FALSE:857               
                                                                 
 integrated_fitCons_score_rankscore PolyPhen_score  SIFT_score     
 Mode :logical                      Mode :logical   Mode :logical  
 FALSE:857                          FALSE:857       FALSE:857      
                                                                   
 CADD_raw_rankscore DANN_rankscore  Eigen.PC.raw_rankscore
 Mode :logical      Mode :logical   Mode :logical         
 FALSE:857          FALSE:857       FALSE:857             
                                                          
 FATHMM_converted_rankscore GERP.._RS_rankscore
 Mode :logical              Mode :logical      
 FALSE:857                  FALSE:857          
                                               
 GM12878_fitCons_score_rankscore.1 GenoCanyon_score_rankscore.1
 Mode :logical                     Mode :logical               
 FALSE:857                         FALSE:857                   
                                                               
 H1.hESC_fitCons_score_rankscore.1 HUVEC_fitCons_score_rankscore.1
 Mode :logical                     Mode :logical                  
 FALSE:857                         FALSE:857                      
                                                                  
 MetaLR_rankscore MetaSVM_rankscore MutationAssessor_score_rankscore.1
 Mode :logical    Mode :logical     Mode :logical                     
 FALSE:857        FALSE:857         FALSE:857                         
                                                                      
 MutationTaster_converted_rankscore REVEL_rankscore
 Mode :logical                      Mode :logical  
 FALSE:857                          FALSE:857      
                                                   
 SiPhy_29way_logOdds_rankscore VEST3_rankscore fathmm.MKL_coding_rankscore
 Mode :logical                 Mode :logical   Mode :logical              
 FALSE:857                     FALSE:857       FALSE:857                  
                                                                          
 integrated_fitCons_score_rankscore.1 phastCons100way_vertebrate_rankscore
 Mode :logical                        Mode :logical                       
 FALSE:857                            FALSE:857                           
                                                                          
 phastCons20way_mammalian_rankscore phyloP100way_vertebrate_rankscore
 Mode :logical                      Mode :logical                    
 FALSE:857                          FALSE:857                        
                                                                     
 phyloP20way_mammalian_rankscore Reliability_index GERP.._NR      
 Mode :logical                   Mode :logical     Mode :logical  
 FALSE:857                       FALSE:857         FALSE:857      
                                                                  
 SiPhy_29way_logOdds SiPhy_29way_logOdds_rankscore.1 phastCons20way_mammalian
 Mode :logical       Mode :logical                   Mode :logical           
 FALSE:857           FALSE:857                       FALSE:857               
                                                                             
 df.freq.gnomAD_exomes_AF df.freq.gnomAD_genomes_AF   labels       
 Mode :logical            Mode :logical             Mode :logical  
 FALSE:857                FALSE:857                 FALSE:857      
                                                                   </code></pre>
</div>
</div>
<p>There was some missing data, but only in 25 rows out of 857 (2.91%) and only in the GenoCanyon_score column. Because there was such little data missing, I decided to simply remove the rows with missing data rather than using a multiple imputation method such as MICE as the missing data would not skew the results.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb30"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a>epilepsy_no_na <span class="ot">&lt;-</span> pheno_patho_joined <span class="sc">%&gt;%</span> </span>
<span id="cb30-2"><a href="#cb30-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(phenotype <span class="sc">==</span> <span class="st">"epilepsy"</span>) <span class="sc">%&gt;%</span> <span class="co"># Filter the table so it only shows epilepsy phenotypes</span></span>
<span id="cb30-3"><a href="#cb30-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">na.omit</span>() <span class="co"># Remove rows with missing data</span></span>
<span id="cb30-4"><a href="#cb30-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-5"><a href="#cb30-5" aria-hidden="true" tabindex="-1"></a>muscular_no_na <span class="ot">&lt;-</span> pheno_patho_joined <span class="sc">%&gt;%</span></span>
<span id="cb30-6"><a href="#cb30-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(phenotype <span class="sc">==</span> <span class="st">"muscular_conditions"</span>) <span class="sc">%&gt;%</span> <span class="co"># Filter the table so it only shows muscular condition phenotypes</span></span>
<span id="cb30-7"><a href="#cb30-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">na.omit</span>() <span class="co"># Removes rows with missing data</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>I filtered the overall joined table to make two new separate ones with just epilepsy and just muscular conditions because it would mean I could run their own random forest models and compare the results.</p>
</section>
<section id="create-shuffled-epilepsy-and-muscular-conditions-sets-and-run-the-predictions" class="level2">
<h2 class="anchored" data-anchor-id="create-shuffled-epilepsy-and-muscular-conditions-sets-and-run-the-predictions">Create Shuffled Epilepsy and Muscular Conditions Sets and Run the Predictions</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb31"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a>epilepsy_shuffled <span class="ot">&lt;-</span> epilepsy_no_na[<span class="fu">sample</span>(<span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(epilepsy_no_na)),] <span class="co"># Shuffles the data sets so it's random and unbiased</span></span>
<span id="cb31-2"><a href="#cb31-2" aria-hidden="true" tabindex="-1"></a>muscular_shuffled <span class="ot">&lt;-</span> muscular_no_na[<span class="fu">sample</span>(<span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(muscular_no_na)),]</span>
<span id="cb31-3"><a href="#cb31-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-4"><a href="#cb31-4" aria-hidden="true" tabindex="-1"></a>epilepsy_pred <span class="ot">&lt;-</span> <span class="fu">predict</span>(humvar_train_rf, epilepsy_shuffled) <span class="co"># Make predictions on the labels of the epilepsy and muscular condition sets based</span></span>
<span id="cb31-5"><a href="#cb31-5" aria-hidden="true" tabindex="-1"></a>                                                             <span class="co"># on the trained random forest model</span></span>
<span id="cb31-6"><a href="#cb31-6" aria-hidden="true" tabindex="-1"></a>muscular_pred <span class="ot">&lt;-</span> <span class="fu">predict</span>(humvar_train_rf, muscular_shuffled)</span>
<span id="cb31-7"><a href="#cb31-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-8"><a href="#cb31-8" aria-hidden="true" tabindex="-1"></a>epilepsy_cm <span class="ot">&lt;-</span> <span class="fu">table</span>(epilepsy_pred,epilepsy_shuffled<span class="sc">$</span>labels) <span class="co"># Create the confusion matrices from the predictions</span></span>
<span id="cb31-9"><a href="#cb31-9" aria-hidden="true" tabindex="-1"></a>muscular_cm <span class="ot">&lt;-</span> <span class="fu">table</span>(muscular_pred,muscular_shuffled<span class="sc">$</span>labels)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb32"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a>epilepsy_cm <span class="co"># View the confusion matrices</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>             
epilepsy_pred Benign Pathogenic
   Benign         71         22
   Pathogenic     18        179</code></pre>
</div>
<div class="sourceCode cell-code" id="cb34"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a>muscular_cm</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>             
muscular_pred Benign Pathogenic
   Benign        293         14
   Pathogenic     22        213</code></pre>
</div>
</div>
</section>
<section id="report-each-sets-accuracy-true-positive-rate-and-false-positive-rate" class="level2">
<h2 class="anchored" data-anchor-id="report-each-sets-accuracy-true-positive-rate-and-false-positive-rate">Report Each Set’s Accuracy, True Positive Rate and False Positive Rate</h2>
<section id="epilepsy" class="level3">
<h3 class="anchored" data-anchor-id="epilepsy">Epilepsy</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb36"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a>epilepsy_pred_accuracy <span class="ot">&lt;-</span> (epilepsy_cm[<span class="dv">1</span>,<span class="dv">1</span>] <span class="sc">+</span> epilepsy_cm[<span class="dv">2</span>,<span class="dv">2</span>]) <span class="sc">/</span> (epilepsy_cm[<span class="dv">1</span>,<span class="dv">1</span>] <span class="sc">+</span> epilepsy_cm[<span class="dv">1</span>,<span class="dv">2</span>] <span class="sc">+</span> epilepsy_cm[<span class="dv">2</span>,<span class="dv">1</span>] <span class="sc">+</span> epilepsy_cm[<span class="dv">2</span>,<span class="dv">2</span>])</span>
<span id="cb36-2"><a href="#cb36-2" aria-hidden="true" tabindex="-1"></a>epilepsy_pred_accuracy</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.862069</code></pre>
</div>
<div class="sourceCode cell-code" id="cb38"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb38-1"><a href="#cb38-1" aria-hidden="true" tabindex="-1"></a>epilepsy_pred_TPR <span class="ot">&lt;-</span> (epilepsy_cm[<span class="dv">2</span>,<span class="dv">2</span>]) <span class="sc">/</span> (epilepsy_cm[<span class="dv">2</span>,<span class="dv">1</span>] <span class="sc">+</span> epilepsy_cm[<span class="dv">2</span>,<span class="dv">2</span>])</span>
<span id="cb38-2"><a href="#cb38-2" aria-hidden="true" tabindex="-1"></a>epilepsy_pred_TPR</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.9086294</code></pre>
</div>
<div class="sourceCode cell-code" id="cb40"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb40-1"><a href="#cb40-1" aria-hidden="true" tabindex="-1"></a>epilepsy_pred_FPR <span class="ot">&lt;-</span> (epilepsy_cm[<span class="dv">1</span>,<span class="dv">2</span>]) <span class="sc">/</span> (epilepsy_cm[<span class="dv">1</span>,<span class="dv">2</span>] <span class="sc">+</span> epilepsy_cm[<span class="dv">1</span>,<span class="dv">1</span>])  </span>
<span id="cb40-2"><a href="#cb40-2" aria-hidden="true" tabindex="-1"></a>epilepsy_pred_FPR </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.2365591</code></pre>
</div>
</div>
</section>
<section id="muscular-conditions" class="level3">
<h3 class="anchored" data-anchor-id="muscular-conditions">Muscular Conditions</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb42"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb42-1"><a href="#cb42-1" aria-hidden="true" tabindex="-1"></a>muscular_pred_accuracy <span class="ot">&lt;-</span> (muscular_cm[<span class="dv">1</span>,<span class="dv">1</span>] <span class="sc">+</span> muscular_cm[<span class="dv">2</span>,<span class="dv">2</span>]) <span class="sc">/</span> (muscular_cm[<span class="dv">1</span>,<span class="dv">1</span>] <span class="sc">+</span> muscular_cm[<span class="dv">1</span>,<span class="dv">2</span>] <span class="sc">+</span> muscular_cm[<span class="dv">2</span>,<span class="dv">1</span>] <span class="sc">+</span> muscular_cm[<span class="dv">2</span>,<span class="dv">2</span>]) </span>
<span id="cb42-2"><a href="#cb42-2" aria-hidden="true" tabindex="-1"></a>muscular_pred_accuracy </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.9335793</code></pre>
</div>
<div class="sourceCode cell-code" id="cb44"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb44-1"><a href="#cb44-1" aria-hidden="true" tabindex="-1"></a>muscular_pred_TPR <span class="ot">&lt;-</span> (muscular_cm[<span class="dv">2</span>,<span class="dv">2</span>]) <span class="sc">/</span> (muscular_cm[<span class="dv">2</span>,<span class="dv">1</span>] <span class="sc">+</span> muscular_cm[<span class="dv">2</span>,<span class="dv">2</span>])</span>
<span id="cb44-2"><a href="#cb44-2" aria-hidden="true" tabindex="-1"></a>muscular_pred_TPR </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.906383</code></pre>
</div>
<div class="sourceCode cell-code" id="cb46"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb46-1"><a href="#cb46-1" aria-hidden="true" tabindex="-1"></a>muscular_pred_FPR <span class="ot">&lt;-</span> (muscular_cm[<span class="dv">1</span>,<span class="dv">2</span>]) <span class="sc">/</span> (muscular_cm[<span class="dv">1</span>,<span class="dv">2</span>] <span class="sc">+</span> muscular_cm[<span class="dv">1</span>,<span class="dv">1</span>]) </span>
<span id="cb46-2"><a href="#cb46-2" aria-hidden="true" tabindex="-1"></a>muscular_pred_FPR </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.04560261</code></pre>
</div>
</div>
</section>
</section>
<section id="plotting-the-receiver-operating-curve" class="level2">
<h2 class="anchored" data-anchor-id="plotting-the-receiver-operating-curve">Plotting the Receiver Operating Curve</h2>
<p>The first thing I had to do was turn the epilepsy and muscular conditions predictions from categorical data into continuous probability data so it could be plotted as a regression:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb48"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb48-1"><a href="#cb48-1" aria-hidden="true" tabindex="-1"></a>epilepsy_probs <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(<span class="fu">predict</span>(humvar_train_rf, epilepsy_shuffled, <span class="at">type =</span> <span class="st">"prob"</span>)) <span class="co"># Change from categorical to continuous</span></span>
<span id="cb48-2"><a href="#cb48-2" aria-hidden="true" tabindex="-1"></a>muscular_probs <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(<span class="fu">predict</span>(humvar_train_rf, muscular_shuffled, <span class="at">type =</span> <span class="st">"prob"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>I then assigned the benign and pathogenic labels the value of 1 or 2 rather than having text-based labels as this made it easier for the ROC function to interpret the data and avoid mistakes:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb49"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb49-1"><a href="#cb49-1" aria-hidden="true" tabindex="-1"></a>epilepsy_num_lab <span class="ot">&lt;-</span> epilepsy_shuffled <span class="sc">%&gt;%</span>  <span class="co"># Change the labels from text based to numeric</span></span>
<span id="cb49-2"><a href="#cb49-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">num_label =</span> <span class="fu">case_when</span>(</span>
<span id="cb49-3"><a href="#cb49-3" aria-hidden="true" tabindex="-1"></a>    labels <span class="sc">==</span> <span class="st">"Benign"</span> <span class="sc">~</span> <span class="dv">1</span>,</span>
<span id="cb49-4"><a href="#cb49-4" aria-hidden="true" tabindex="-1"></a>    labels <span class="sc">==</span> <span class="st">"Pathogenic"</span> <span class="sc">~</span> <span class="dv">2</span></span>
<span id="cb49-5"><a href="#cb49-5" aria-hidden="true" tabindex="-1"></a>  ))</span>
<span id="cb49-6"><a href="#cb49-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-7"><a href="#cb49-7" aria-hidden="true" tabindex="-1"></a>muscular_num_lab <span class="ot">&lt;-</span> muscular_shuffled <span class="sc">%&gt;%</span> </span>
<span id="cb49-8"><a href="#cb49-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">num_label =</span> <span class="fu">case_when</span>(</span>
<span id="cb49-9"><a href="#cb49-9" aria-hidden="true" tabindex="-1"></a>    labels <span class="sc">==</span> <span class="st">"Benign"</span> <span class="sc">~</span> <span class="dv">1</span>,</span>
<span id="cb49-10"><a href="#cb49-10" aria-hidden="true" tabindex="-1"></a>    labels <span class="sc">==</span> <span class="st">"Pathogenic"</span> <span class="sc">~</span> <span class="dv">2</span></span>
<span id="cb49-11"><a href="#cb49-11" aria-hidden="true" tabindex="-1"></a>  ))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Next, for each phenotype, I had to outline the response and predictor values for the ROC curves. The first line for each creates the response values, which are the numerical labels for “benign” and “pathogenic”. The second line creates the predictor values which are based on the probability for each label. For the predictors it did not matter which pathogenicity I chose as they are both proportional to each other.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb50"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb50-1"><a href="#cb50-1" aria-hidden="true" tabindex="-1"></a>epilepsy_labels <span class="ot">=</span> <span class="fu">c</span>(epilepsy_num_lab<span class="sc">$</span>num_label)  <span class="co"># Set the response values</span></span>
<span id="cb50-2"><a href="#cb50-2" aria-hidden="true" tabindex="-1"></a>epilepsy_benign_predictor <span class="ot">=</span> <span class="fu">c</span>(epilepsy_probs<span class="sc">$</span>Benign) <span class="co"># Set the predictor values</span></span>
<span id="cb50-3"><a href="#cb50-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-4"><a href="#cb50-4" aria-hidden="true" tabindex="-1"></a>muscular_labels <span class="ot">=</span> <span class="fu">c</span>(muscular_num_lab<span class="sc">$</span>num_label) <span class="co"># Set the response values</span></span>
<span id="cb50-5"><a href="#cb50-5" aria-hidden="true" tabindex="-1"></a>muscular_benign_predictor <span class="ot">=</span> <span class="fu">c</span>(muscular_probs<span class="sc">$</span>Benign) <span class="co"># Set the predictor values </span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Next I ran the ROC calculations:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb51"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb51-1"><a href="#cb51-1" aria-hidden="true" tabindex="-1"></a>epilepsy_roc <span class="ot">&lt;-</span> <span class="fu">roc</span>(<span class="at">response =</span> epilepsy_labels, <span class="at">predictor =</span> epilepsy_benign_predictor) <span class="co"># calculate ROC</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Setting levels: control = 1, case = 2</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Setting direction: controls &gt; cases</code></pre>
</div>
<div class="sourceCode cell-code" id="cb54"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb54-1"><a href="#cb54-1" aria-hidden="true" tabindex="-1"></a>muscular_roc <span class="ot">&lt;-</span> <span class="fu">roc</span>(<span class="at">response =</span> muscular_labels, <span class="at">predictor =</span> muscular_benign_predictor)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Setting levels: control = 1, case = 2
Setting direction: controls &gt; cases</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb56"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb56-1"><a href="#cb56-1" aria-hidden="true" tabindex="-1"></a>epilepsy_roc</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
roc.default(response = epilepsy_labels, predictor = epilepsy_benign_predictor)

Data: epilepsy_benign_predictor in 89 controls (epilepsy_labels 1) &gt; 201 cases (epilepsy_labels 2).
Area under the curve: 0.9334</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb58"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb58-1"><a href="#cb58-1" aria-hidden="true" tabindex="-1"></a>muscular_roc</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
roc.default(response = muscular_labels, predictor = muscular_benign_predictor)

Data: muscular_benign_predictor in 315 controls (muscular_labels 1) &gt; 227 cases (muscular_labels 2).
Area under the curve: 0.9748</code></pre>
</div>
</div>
<p>Finally, I plotted the ROC curves and joined them together</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb60"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb60-1"><a href="#cb60-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(epilepsy_roc, <span class="at">col =</span> <span class="st">"blue"</span>, <span class="at">main =</span> <span class="st">"ROC Curves for Epilepsy &amp; Muscular Conditions"</span>)</span>
<span id="cb60-2"><a href="#cb60-2" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(muscular_roc, <span class="at">col =</span> <span class="st">"red"</span>)</span>
<span id="cb60-3"><a href="#cb60-3" aria-hidden="true" tabindex="-1"></a><span class="fu">legend</span>(<span class="st">"bottomright"</span>, <span class="at">legend =</span> <span class="fu">c</span>(<span class="st">"Epilepsy"</span>, <span class="st">"Muscular Conditions"</span>),</span>
<span id="cb60-4"><a href="#cb60-4" aria-hidden="true" tabindex="-1"></a>       <span class="at">col =</span> <span class="fu">c</span>(<span class="st">"blue"</span>, <span class="st">"red"</span>), <span class="at">lwd =</span> <span class="dv">2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Assessment_2_WU_files/figure-html/unnamed-chunk-19-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>Sensitivity in the ROC curves represents the true positive rate (TPR) and specificity represents the true negative rate (TNR). These values are plotted for certain thresholds for labelling variants as pathogenic or benign. As high values for sensitivity (TPR) and specificity (TNR) mean a more accurate ML model, having both values as close to 1.0 as possible on the ROC curve will represent this more accurate model. As such, a dataset’s curve that has a higher area under the curve (AUC) will mean the predictions made for this dataset are more accurate and reliable. From the plot, we can see that the curve for muscular conditions has a higher AUC than the curve for epilepsy. This means that the predictions for pathogenic outcomes of genetic variants in muscular conditions are more accurate and reliable in this model than they are for epilepsy. This is also represented by the accuracies, TPRs and FPRs calculated using the confusion matrices.</p>
</section>
</section>
<section id="relevancy-of-results" class="level1">
<h1>Relevancy of Results</h1>
<p>These findings show that the accuracies of this model are not high enough to be used as the sole basis of diagnosing a patient for muscular conditions or epilepsy purely based on the presence of mutation IDs that have been labelled as pathogenic. This is because the accuracies for muscular conditions and epilepsy are not high enough to make decisions based on the ML model alone, particularly for epilepsy as all of the results show it is harder to predict a pathogenic outcome for it than muscular conditions. Instead, this model should be used to encourage clinician based examinations of patients with pathogenically labelled mutations, as there is still a calculatedly high probability that these mutations can lead to a pathogenic outcome.</p>
</section>

</main>
<!-- /main column -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const onCopySuccess = function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  }
  const getTextToCopy = function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
    text: getTextToCopy
  });
  clipboard.on('success', onCopySuccess);
  if (window.document.getElementById('quarto-embedded-source-code-modal')) {
    const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
      text: getTextToCopy,
      container: window.document.getElementById('quarto-embedded-source-code-modal')
    });
    clipboardModal.on('success', onCopySuccess);
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp('/' + window.location.host + '/');
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->




</body></html>